<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport"></meta>
    <title>2010VS.2014台北市吸票增加數（率） - Google Fusion Tables</title>
    <style type="text/css">
    html,
    body,
    #googft-mapCanvas {
        height: 600px;
        margin: 0;
        padding: 0;
        width: auto;
    }
    #googft-legend {
        background-color: #fff;
        border: 1px solid #000;
        font-family: Arial, sans-serif;
        font-size: 12px;
        margin: 5px;
        padding: 10px 10px 8px;
    }
    #googft-legend p {
        font-weight: bold;
        margin-top: 0;
    }
    #googft-legend div {
        margin-bottom: 5px;
    }
    .googft-legend-swatch {
        border: 1px solid;
        float: left;
        height: 12px;
        margin-right: 8px;
        width: 20px;
    }
    .googft-legend-range {
        margin-left: 0;
    }
    .googft-dot-icon {
        margin-right: 8px;
    }
    .googft-paddle-icon {
        height: 24px;
        left: -8px;
        margin-right: -8px;
        position: relative;
        vertical-align: middle;
        width: 24px;
    }
    .googft-legend-source {
        margin-bottom: 0;
        margin-top: 8px;
    }
    .googft-legend-source a {
        color: #666;
        font-size: 11px;
    }
    </style>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">
    var infowindow;

    function initialize() {
        google.maps.visualRefresh = true;
        var isMobile = (navigator.userAgent.toLowerCase().indexOf('android') > -1) ||
            (navigator.userAgent.match(/(iPod|iPhone|iPad|BlackBerry|Windows Phone|iemobile)/));
        if (isMobile) {
            var viewport = document.querySelector("meta[name=viewport]");
            viewport.setAttribute('content', 'initial-scale=1.0, user-scalable=no');
        }
        var mapDiv = document.getElementById('googft-mapCanvas');
        var map = new google.maps.Map(mapDiv, {
            center: new google.maps.LatLng(25.052587489881063, 121.59907103466799),
            zoom: 13,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(document.getElementById('googft-legend-open'));
        map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(document.getElementById('googft-legend'));

        layer = new google.maps.FusionTablesLayer({
            map: map,
            heatmap: {
                enabled: false
            },
            query: {
                select: "col24\x3e\x3e0",
                from: "1Y8vmRuyWfR2lwz97xFxnbZew9XfRMdcFpYEljGRV",
                where: ""
            },
            options: {
                styleId: 3,
                suppressInfoWindows: true,
                templateId: 3
            }
        });

        if (isMobile) {
            var legend = document.getElementById('googft-legend');
            var legendOpenButton = document.getElementById('googft-legend-open');
            var legendCloseButton = document.getElementById('googft-legend-close');
            legend.style.display = 'none';
            legendOpenButton.style.display = 'block';
            legendCloseButton.style.display = 'block';
            legendOpenButton.onclick = function() {
                legend.style.display = 'block';
                legendOpenButton.style.display = 'none';
            }
            legendCloseButton.onclick = function() {
                legend.style.display = 'none';
                legendOpenButton.style.display = 'block';
            }
        }
        google.maps.event.addListener(layer, 'click', function(e) {
            var nodeCol = document.createElement('div');
            if (infowindow) infowindow.close();
            else infowindow = new google.maps.InfoWindow();
            infowindow.setContent(
                '<div id="tab-2" style="overflow:hidden;">' + //firts tab content 
                '<h3><b>' + e.row['TVNAME'].value + '</b></h3>' +
                '<b align="left">得票差：' + e.row['diff'].value + '</b>' +
                '</br>' +
                '<b align="left">2010 VS. 2014 得票率增加：' + e.row['Rate'].value + '</b>' +
                '</br>' +
                '<iframe frameborder="no" src="https://www.google.com/fusiontables/embedviz?containerId=googft-gviz-canvas&q=select+col6%3E%3E0%2C+col4%3E%3E1%2C+col5%3E%3E1%2C+col6%3E%3E1+from+1Y8vmRuyWfR2lwz97xFxnbZew9XfRMdcFpYEljGRV+%20WHERE%20TVNAME=%27' + e.row['TVNAME'].value + '%27+order+by+col6%3E%3E0+asc+limit+10&viz=GVIZ&t=COLUMN&uiversion=2&gco_forceIFrame=true&gco_hasLabelsColumn=true&gco_vAxes=%5B%7B%22title%22%3A%22%E7%A5%A8%E6%95%B8%22%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22useFormatFromData%22%3Atrue%2C+%22viewWindow%22%3A%7B%22max%22%3Anull%2C+%22min%22%3Anull%7D%7D%2C%7B%22useFormatFromData%22%3Atrue%2C+%22viewWindow%22%3A%7B%22max%22%3Anull%2C+%22min%22%3Anull%7D%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%7D%5D&gco_useFirstColumnAsDomain=true&gco_isStacked=false&gco_booleanRole=certainty&gco_hAxis=%7B%22useFormatFromData%22%3Atrue%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22viewWindow%22%3Anull%2C+%22viewWindowMode%22%3Anull%7D&gco_legend=none&gco_series=%7B%220%22%3A%7B%22color%22%3A%22%2300ff00%22%7D%2C+%221%22%3A%7B%22color%22%3A%22%23cccccc%22%7D%2C+%222%22%3A%7B%22color%22%3A%22none%22%7D%7D&gco_theme=maximized&gco_tooltip=%7B%22isHtml%22%3Atrue%7D&tmplt=4&width=220&height=140" width="270" height="150" scrolling="no" />' +
                '</div>');
            infowindow.setPosition(e.latLng);
            infowindow.open(map);
        });
        infoWindow = new google.maps.InfoWindow();
    }
    google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>

<body>
    <h1>2010 VS.2014台北市蘇柯吸票增加數（率）</h1>
    <div id="container">
        <ol>
            <h3>圖表說明：</h3>
            <li>比較2010與2014兩年度的選舉，蘇與柯吸票率對比。吸票率分為五級級距：
                <ul>
                    <li>（1）-0.037～0.03</li>
                    <li>（2）0～0.038</li>
                    <li>（3）0.038～0.075</li>
                    <li>（4）0.075～0.113</li>
                    <li>（5）0.113～0.15</li>
                </ul>
            </li>
            <li>直接點選各里區域，便會顯示2010與2014年蘇柯票數差距圖表與得票率增加數據。</li>
        </ol>
    </div>
    <div id="googft-mapCanvas"></div>
    <input id="googft-legend-open" style="display:none" type="button" value="Legend"></input>
    <div id="googft-legend">
        <p id="googft-legend-title">吸票增加率</p>
        <div>
            <span class="googft-legend-swatch" style="background-color: #0000ff"></span>
            <span class="googft-legend-range">-3.7% to 0%</span>
        </div>
        <div>
            <span class="googft-legend-swatch" style="background-color: #00ff00"></span>
            <span class="googft-legend-range">0% to 3.8%</span>
        </div>
        <div>
            <span class="googft-legend-swatch" style="background-color: #38761d"></span>
            <span class="googft-legend-range">3.8% to 7.5%</span>
        </div>
        <div>
            <span class="googft-legend-swatch" style="background-color: #ff9900"></span>
            <span class="googft-legend-range">7.5% to 11.3%</span>
        </div>
        <div>
            <span class="googft-legend-swatch" style="background-color: #ffff00"></span>
            <span class="googft-legend-range">11.3% to 11.5%</span>
        </div>
        <input id="googft-legend-close" style="display:none" type="button" value="Hide"></input>
    </div>

</body>

</html>
